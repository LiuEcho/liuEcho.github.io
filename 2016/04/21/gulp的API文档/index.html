

<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    
    <meta name="author" content="Liu Chang">
    
    <meta name="description" content="gulp API 文档gulp.src(globs[, options])输出（Emits）符合所提供的匹配模式（glob）或者匹配模式的数组（array of globs）的文件。将返回一个 Vinyl files 的 stream它可以被 piped 到别的插件中。
1234gulp.src(&#39;">
    
    

    
    <link rel="alternative" href="YOUR_RSS_ADDRESS" title="Echo" type="application/atom+xml">
    
    
    

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>gulp的API文档 | Echo</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="/css/style.css" type="text/css">

    <!-- Javascript -->
    <script src="/js/jquery-2.1.0.min.js"></script>
    <script src="/js/jquery.backstretch.min.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    <script src="/js/headroom.min.js"></script>
    <script src="/js/jquery.headroom.min.js"></script> 
    <script src="/js/common.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="banner">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://liuecho.me" title="Echo">Echo</a>
            </div>

            <div role="navigation" class="collapse navbar-collapse bs-navbar-collapse">
                

                <ul class="nav navbar-nav">
                    
                    <li id="nav-index"><a href="/">首页</a></li>
                    
                    <li id="nav-archives"><a href="/archives">归档</a></li>
                    
                    <li id="nav-tags"><a href="/tags">标签</a></li>
                    
                    <li id="nav-categories"><a href="/categories">分类</a></li>
                    
                    <li id="nav-about"><a href="/about">关于</a></li>
                    
                    
                    <li><a href="https://github.com/liuecho" target="_blank">GitHub</a></li>
                </ul>
            </div>
        </div>
    </nav>
    
    <script>
    var backRoot = "/images/background/";
    var backArray = [ "1.jpg", "2.jpg", "3.jpg", "4.jpg", "5.jpg", "6.jpg", "7.jpg", "8.jpg",  ];
        
    $(function() {
        // page-id...
        var pageId = "2016/04/21/gulp的API文档/";
        pageId = pageId.substr(0, pageId.indexOf("/"));
        if(pageId === "") pageId = "index";
        
        $("#nav-" + pageId).addClass("active");
    });
    </script>

    <article class="post container">
    <div class="well post-body first-post last-post">
        <h1>gulp的API文档</h1>
        
        <div class="time-info">
发表于:<time datetime="2016-04-21T06:27:09.000Z" itemprop="datePublished">2016-04-21</time>，更新于:<time datetime="2016-04-21T06:28:10.688Z" itemprop="dateModified">2016-04-21</time>，By <a href="http://liuecho.me" title="Liu Chang">Liu Chang</a>
        </div>
        
        <div class="post-body-inner">
            <div id="toc" class="toc-article well">
                <strong class="toc-title">大纲</strong>
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#gulp_API__u6587_u6863"><span class="toc-number">1.</span> <span class="toc-text">gulp API 文档</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#gulp-src_28globs_5B_2C_options_5D_29"><span class="toc-number">1.1.</span> <span class="toc-text">gulp.src(globs[, options])</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#globs"><span class="toc-number">1.1.1.</span> <span class="toc-text">globs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#options"><span class="toc-number">1.1.2.</span> <span class="toc-text">options</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#options-buffer"><span class="toc-number">1.1.3.</span> <span class="toc-text">options.buffer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#options-read"><span class="toc-number">1.1.4.</span> <span class="toc-text">options.read</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#options-base"><span class="toc-number">1.1.5.</span> <span class="toc-text">options.base</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gulp-dest_28path_5B_2C_options_5D_29"><span class="toc-number">1.2.</span> <span class="toc-text">gulp.dest(path[, options])</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#path"><span class="toc-number">1.2.1.</span> <span class="toc-text">path</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#options-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">options</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#options-cwd"><span class="toc-number">1.2.3.</span> <span class="toc-text">options.cwd</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#options-mode"><span class="toc-number">1.2.4.</span> <span class="toc-text">options.mode</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gulp-task_28name_5B_2C_deps_5D_2C_fn_29"><span class="toc-number">1.3.</span> <span class="toc-text">gulp.task(name[, deps], fn)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#name"><span class="toc-number">1.3.1.</span> <span class="toc-text">name</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#deps"><span class="toc-number">1.3.2.</span> <span class="toc-text">deps</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fn"><span class="toc-number">1.3.3.</span> <span class="toc-text">fn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#u5F02_u6B65_u4EFB_u52A1_u652F_u6301"><span class="toc-number">1.3.4.</span> <span class="toc-text">异步任务支持</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#u63A5_u53D7_u4E00_u4E2A_callback"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">接受一个 callback</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#u8FD4_u56DE_u4E00_u4E2A_stream"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">返回一个 stream</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#u8FD4_u56DE_u4E00_u4E2A_promise"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">返回一个 promise</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gulp-watch_28glob__5B_2C_opts_5D_2C_tasks_29__u6216_gulp-watch_28glob__5B_2C_opts_2C_cb_5D_29"><span class="toc-number">1.4.</span> <span class="toc-text">gulp.watch(glob [, opts], tasks) 或 gulp.watch(glob [, opts, cb])</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gulp-watch_28glob_5B_2C_opts_5D_2C_tasks_29"><span class="toc-number">1.5.</span> <span class="toc-text">gulp.watch(glob[, opts], tasks)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#glob"><span class="toc-number">1.5.1.</span> <span class="toc-text">glob</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#opts"><span class="toc-number">1.5.2.</span> <span class="toc-text">opts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#tasks"><span class="toc-number">1.5.3.</span> <span class="toc-text">tasks</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gulp-watch_28glob_5B_2C_opts_2C_cb_5D_29"><span class="toc-number">1.6.</span> <span class="toc-text">gulp.watch(glob[, opts, cb])</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#glob-1"><span class="toc-number">1.6.1.</span> <span class="toc-text">glob</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#opts-1"><span class="toc-number">1.6.2.</span> <span class="toc-text">opts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cb_28event_29"><span class="toc-number">1.6.3.</span> <span class="toc-text">cb(event)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#event-type"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">event.type</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#event-path"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">event.path</span></a></li></ol></li></ol></li></ol></li></ol>
            </div>
            
            <h2 id="gulp_API__u6587_u6863"><a href="#gulp_API__u6587_u6863" class="headerlink" title="gulp API 文档"></a>gulp API 文档</h2><h3 id="gulp-src_28globs_5B_2C_options_5D_29"><a href="#gulp-src_28globs_5B_2C_options_5D_29" class="headerlink" title="gulp.src(globs[, options])"></a>gulp.src(globs[, options])</h3><p>输出（Emits）符合所提供的匹配模式（glob）或者匹配模式的数组（array of globs）的文件。<br>将返回一个 <a href="https://github.com/wearefractal/vinyl-fs" target="_blank" rel="external">Vinyl files</a> 的 <a href="http://nodejs.org/api/stream.html" target="_blank" rel="external">stream</a><br>它可以被 <a href="http://nodejs.org/api/stream.html#stream_readable_pipe_destination_options" target="_blank" rel="external">piped</a> 到别的插件中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gulp.src(<span class="string">'client/templates/*.jade'</span>)</span><br><span class="line">  .pipe(jade())</span><br><span class="line">  .pipe(minify())</span><br><span class="line">  .pipe(gulp.dest(<span class="string">'build/minified_templates'</span>));</span><br></pre></td></tr></table></figure>
<p><code>glob</code> 请参考 <a href="https://github.com/isaacs/node-glob" target="_blank" rel="external">node-glob 语法</a> 或者，你也可以直接写文件的路径。</p>
<h4 id="globs"><a href="#globs" class="headerlink" title="globs"></a>globs</h4><p>类型： <code>String</code> 或 <code>Array</code></p>
<p>所要读取的 glob 或者包含 globs 的数组。</p>
<h4 id="options"><a href="#options" class="headerlink" title="options"></a>options</h4><p>类型： <code>Object</code></p>
<p>通过 <a href="https://github.com/wearefractal/glob-stream" target="_blank" rel="external">glob-stream</a> 所传递给 <a href="https://github.com/isaacs/node-glob" target="_blank" rel="external">node-glob</a> 的参数。</p>
<p>除了 <a href="https://github.com/isaacs/node-glob#options" target="_blank" rel="external">node-glob</a> 和 <a href="https://github.com/wearefractal/glob-stream" target="_blank" rel="external">glob-stream</a> 所支持的参数外，gulp 增加了一些额外的选项参数：</p>
<h4 id="options-buffer"><a href="#options-buffer" class="headerlink" title="options.buffer"></a>options.buffer</h4><p>类型： <code>Boolean</code><br>默认值： <code>true</code></p>
<p>如果该项被设置为 <code>false</code>，那么将会以 stream 方式返回 <code>file.contents</code> 而不是文件 buffer 的形式。这在处理一些大文件的时候将会很有用。<strong>注意：</strong>插件可能并不会实现对 stream 的支持。</p>
<h4 id="options-read"><a href="#options-read" class="headerlink" title="options.read"></a>options.read</h4><p>类型： <code>Boolean</code><br>默认值： <code>true</code></p>
<p>如果该项被设置为 <code>false</code>， 那么 <code>file.contents</code> 会返回空值（null），也就是并不会去读取文件。</p>
<h4 id="options-base"><a href="#options-base" class="headerlink" title="options.base"></a>options.base</h4><p>类型： <code>String</code><br>默认值： 将会加在 glob 之前 (请看 <a href="https://github.com/wearefractal/glob2base" target="_blank" rel="external">glob2base</a>)</p>
<p>如, 请想像一下在一个路径为 <code>client/js/somedir</code> 的目录中，有一个文件叫 <code>somefile.js</code> ：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gulp.src(<span class="string">'client/js/**/*.js'</span>) <span class="comment">// 匹配 'client/js/somedir/somefile.js' 并且将 `base` 解析为 `client/js/`</span></span><br><span class="line">  .pipe(minify())</span><br><span class="line">  .pipe(gulp.dest(<span class="string">'build'</span>));  <span class="comment">// 写入 'build/somedir/somefile.js'</span></span><br><span class="line"></span><br><span class="line">gulp.src(<span class="string">'client/js/**/*.js'</span>, &#123; base: <span class="string">'client'</span> &#125;)</span><br><span class="line">  .pipe(minify())</span><br><span class="line">  .pipe(gulp.dest(<span class="string">'build'</span>));  <span class="comment">// 写入 'build/js/somedir/somefile.js'</span></span><br></pre></td></tr></table></figure>
<h3 id="gulp-dest_28path_5B_2C_options_5D_29"><a href="#gulp-dest_28path_5B_2C_options_5D_29" class="headerlink" title="gulp.dest(path[, options])"></a>gulp.dest(path[, options])</h3><p>能被 pipe 进来，并且将会写文件。并且重新输出（emits）所有数据，因此你可以将它 pipe 到多个文件夹。如果某文件夹不存在，将会自动创建它。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gulp.src(<span class="string">'./client/templates/*.jade'</span>)</span><br><span class="line">  .pipe(jade())</span><br><span class="line">  .pipe(gulp.dest(<span class="string">'./build/templates'</span>))</span><br><span class="line">  .pipe(minify())</span><br><span class="line">  .pipe(gulp.dest(<span class="string">'./build/minified_templates'</span>));</span><br></pre></td></tr></table></figure>
<p>文件被写入的路径是以所给的相对路径根据所给的目标目录计算而来。类似的，相对路径也可以根据所给的 base 来计算。<br>请查看上述的 <code>gulp.src</code> 来了解更多信息。</p>
<h4 id="path"><a href="#path" class="headerlink" title="path"></a>path</h4><p>类型： <code>String</code> or <code>Function</code></p>
<p>文件将被写入的路径（输出目录）。也可以传入一个函数，在函数中返回相应路径，这个函数也可以由 <a href="https://github.com/wearefractal/vinyl" target="_blank" rel="external">vinyl 文件实例</a> 来提供。</p>
<h4 id="options-1"><a href="#options-1" class="headerlink" title="options"></a>options</h4><p>类型： <code>Object</code></p>
<h4 id="options-cwd"><a href="#options-cwd" class="headerlink" title="options.cwd"></a>options.cwd</h4><p>类型： <code>String</code><br>默认值： <code>process.cwd()</code></p>
<p>输出目录的 <code>cwd</code> 参数，只在所给的输出目录是相对路径时候有效。</p>
<h4 id="options-mode"><a href="#options-mode" class="headerlink" title="options.mode"></a>options.mode</h4><p>类型： <code>String</code><br>默认值： <code>0777</code></p>
<p>八进制权限字符，用以定义所有在输出目录中所创建的目录的权限。</p>
<h3 id="gulp-task_28name_5B_2C_deps_5D_2C_fn_29"><a href="#gulp-task_28name_5B_2C_deps_5D_2C_fn_29" class="headerlink" title="gulp.task(name[, deps], fn)"></a>gulp.task(name[, deps], fn)</h3><p>定义一个使用 <a href="https://github.com/robrich/orchestrator" target="_blank" rel="external">Orchestrator</a> 实现的任务（task）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'somename'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 做一些事</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="name"><a href="#name" class="headerlink" title="name"></a>name</h4><p>任务的名字，如果你需要在命令行中运行你的某些任务，那么，请不要在名字中使用空格。</p>
<h4 id="deps"><a href="#deps" class="headerlink" title="deps"></a>deps</h4><p>类型： <code>Array</code></p>
<p>一个包含任务列表的数组，这些任务会在你当前任务运行之前完成。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'mytask'</span>, [<span class="string">'array'</span>, <span class="string">'of'</span>, <span class="string">'task'</span>, <span class="string">'names'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 做一些事</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong> 你的任务是否在这些前置依赖的任务完成之前运行了？请一定要确保你所依赖的任务列表中的任务都使用了正确的异步执行方式：使用一个 callback，或者返回一个 promise 或 stream。</p>
<p>你也可以省略最后那个函数，如果你只是想要执行依赖的任务：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'mytask'</span>, [<span class="string">'array'</span>, <span class="string">'of'</span>, <span class="string">'task'</span>, <span class="string">'names'</span>]);</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong> 这些任务会一次并发执行，因此，请不要假定他们会按顺序开始和结束。</p>
<h4 id="fn"><a href="#fn" class="headerlink" title="fn"></a>fn</h4><p>该函数定义任务所要执行的一些操作。通常来说，它会是这种形式：<code>gulp.src().pipe(someplugin())</code>。</p>
<h4 id="u5F02_u6B65_u4EFB_u52A1_u652F_u6301"><a href="#u5F02_u6B65_u4EFB_u52A1_u652F_u6301" class="headerlink" title="异步任务支持"></a>异步任务支持</h4><p>任务可以异步执行，如果 <code>fn</code> 能做到以下其中一点：</p>
<h5 id="u63A5_u53D7_u4E00_u4E2A_callback"><a href="#u63A5_u53D7_u4E00_u4E2A_callback" class="headerlink" title="接受一个 callback"></a>接受一个 callback</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在 shell 中执行一个命令</span></span><br><span class="line"><span class="keyword">var</span> exec = <span class="built_in">require</span>(<span class="string">'child_process'</span>).exec;</span><br><span class="line">gulp.task(<span class="string">'jekyll'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 编译 Jekyll</span></span><br><span class="line">  exec(<span class="string">'jekyll build'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> cb(err); <span class="comment">// 返回 error</span></span><br><span class="line">    cb(); <span class="comment">// 完成 task</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="u8FD4_u56DE_u4E00_u4E2A_stream"><a href="#u8FD4_u56DE_u4E00_u4E2A_stream" class="headerlink" title="返回一个 stream"></a>返回一个 stream</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'somename'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> stream = gulp.src(<span class="string">'client/**/*.js'</span>)</span><br><span class="line">    .pipe(minify())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'build'</span>));</span><br><span class="line">  <span class="keyword">return</span> stream;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="u8FD4_u56DE_u4E00_u4E2A_promise"><a href="#u8FD4_u56DE_u4E00_u4E2A_promise" class="headerlink" title="返回一个 promise"></a>返回一个 promise</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Q = <span class="built_in">require</span>(<span class="string">'q'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'somename'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> deferred = Q.defer();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行异步的操作</span></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    deferred.resolve();</span><br><span class="line">  &#125;, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> deferred.promise;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong> 默认的，task 将以最大的并发数执行，也就是说，gulp 会一次性运行所有的 task 并且不做任何等待。如果你想要创建一个序列化的 task 队列，并以特定的顺序执行，你需要做两件事：</p>
<ul>
<li>给出一个提示，来告知 task 什么时候执行完毕，</li>
<li>并且再给出一个提示，来告知一个 task 依赖另一个 task 的完成。</li>
</ul>
<p>对于这个例子，让我们先假定你有两个 task，”one” 和 “two”，并且你希望它们按照这个顺序执行：</p>
<ol>
<li><p>在 “one” 中，你加入一个提示，来告知什么时候它会完成：可以再完成时候返回一个 callback，或者返回一个 promise 或 stream，这样系统会去等待它完成。</p>
</li>
<li><p>在 “two” 中，你需要添加一个提示来告诉系统它需要依赖第一个 task 完成。</p>
</li>
</ol>
<p>因此，这个例子的实际代码将会是这样：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回一个 callback，因此系统可以知道它什么时候完成</span></span><br><span class="line">gulp.task(<span class="string">'one'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 做一些事 -- 异步的或者其他的</span></span><br><span class="line">    cb(err); <span class="comment">// 如果 err 不是 null 或 undefined，则会停止执行，且注意，这样代表执行失败了</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个所依赖的 task 必须在这个 task 执行之前完成</span></span><br><span class="line">gulp.task(<span class="string">'two'</span>, [<span class="string">'one'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 'one' 完成后</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'default'</span>, [<span class="string">'one'</span>, <span class="string">'two'</span>]);</span><br></pre></td></tr></table></figure>
<h3 id="gulp-watch_28glob__5B_2C_opts_5D_2C_tasks_29__u6216_gulp-watch_28glob__5B_2C_opts_2C_cb_5D_29"><a href="#gulp-watch_28glob__5B_2C_opts_5D_2C_tasks_29__u6216_gulp-watch_28glob__5B_2C_opts_2C_cb_5D_29" class="headerlink" title="gulp.watch(glob [, opts], tasks) 或 gulp.watch(glob [, opts, cb])"></a>gulp.watch(glob [, opts], tasks) 或 gulp.watch(glob [, opts, cb])</h3><p>监视文件，并且可以在文件发生改动时候做一些事情。它总会返回一个 EventEmitter 来发射（emit） <code>change</code> 事件。</p>
<h3 id="gulp-watch_28glob_5B_2C_opts_5D_2C_tasks_29"><a href="#gulp-watch_28glob_5B_2C_opts_5D_2C_tasks_29" class="headerlink" title="gulp.watch(glob[, opts], tasks)"></a>gulp.watch(glob[, opts], tasks)</h3><h4 id="glob"><a href="#glob" class="headerlink" title="glob"></a>glob</h4><p>类型： <code>String</code> or <code>Array</code></p>
<p>一个 glob 字符串，或者一个包含多个 glob 字符串的数组，用来指定具体监控哪些文件的变动。</p>
<h4 id="opts"><a href="#opts" class="headerlink" title="opts"></a>opts</h4><p>类型： <code>Object</code></p>
<p>传给 <a href="https://github.com/shama/gaze" target="_blank" rel="external"><code>gaze</code></a> 的参数。</p>
<h4 id="tasks"><a href="#tasks" class="headerlink" title="tasks"></a>tasks</h4><p>类型： <code>Array</code></p>
<p>需要在文件变动后执行的一个或者多个通过 <code>gulp.task()</code> 创建的 task 的名字，</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> watcher = gulp.watch(<span class="string">'js/**/*.js'</span>, [<span class="string">'uglify'</span>,<span class="string">'reload'</span>]);</span><br><span class="line">watcher.on(<span class="string">'change'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'File '</span> + event.path + <span class="string">' was '</span> + event.type + <span class="string">', running tasks...'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="gulp-watch_28glob_5B_2C_opts_2C_cb_5D_29"><a href="#gulp-watch_28glob_5B_2C_opts_2C_cb_5D_29" class="headerlink" title="gulp.watch(glob[, opts, cb])"></a>gulp.watch(glob[, opts, cb])</h3><h4 id="glob-1"><a href="#glob-1" class="headerlink" title="glob"></a>glob</h4><p>类型： <code>String</code> or <code>Array</code></p>
<p>一个 glob 字符串，或者一个包含多个 glob 字符串的数组，用来指定具体监控哪些文件的变动。</p>
<h4 id="opts-1"><a href="#opts-1" class="headerlink" title="opts"></a>opts</h4><p>类型： <code>Object</code></p>
<p>传给 <a href="https://github.com/shama/gaze" target="_blank" rel="external"><code>gaze</code></a> 的参数。</p>
<h4 id="cb_28event_29"><a href="#cb_28event_29" class="headerlink" title="cb(event)"></a>cb(event)</h4><p>类型： <code>Function</code></p>
<p>每次变动需要执行的 callback。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gulp.watch(<span class="string">'js/**/*.js'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'File '</span> + event.path + <span class="string">' was '</span> + event.type + <span class="string">', running tasks...'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>callback 会被传入一个名为 <code>event</code> 的对象。这个对象描述了所监控到的变动：</p>
<h5 id="event-type"><a href="#event-type" class="headerlink" title="event.type"></a>event.type</h5><p>类型： <code>String</code></p>
<p>发生的变动的类型：<code>added</code>, <code>changed</code> 或者 <code>deleted</code>。</p>
<h5 id="event-path"><a href="#event-path" class="headerlink" title="event.path"></a>event.path</h5><p>类型： <code>String</code></p>
<p>触发了该事件的文件的路径。</p>


			
            <section class="comment">
<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="/2016/04/21/gulp的API文档/" data-title="gulp的API文档" data-url="http://liuecho.me/2016/04/21/gulp的API文档/"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"liuecho"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0]
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- 多说公共JS代码 end -->
</section>
        </div>
    </div>
</article>

    <footer id="footer">
        <small>该博客由 <a href="https://hexo.io/" target="_blank">Hexo</a> 强力驱动，搭载 <a href="https://github.com/XadillaX/hexadillax" target="_blank">Hexadillax</a> 主题</small><br />
        <small>&copy; 2016 Liu Chang</small>
    </footer>
    


</body>
</html>

